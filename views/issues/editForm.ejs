<% layout('layouts/boilerplate') %>
    <div class="row">
        <div class="col-6 offset-3">
            <h1 class="text-center">Update Issue</h1>
            <form action="/issues/<%=issue._id%>?_method=PUT" method="POST" novalidate class="validated-issue">
                <div class="mb-3">
                    <label class="form-label" for="title">Title</label>
                    <input class="form-control" type="text" id="title" name="issue[title]" value="<%=issue.title%>"
                        required>
                    <div class="invalid-feedback">
                        Please provide a valid title.
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label" for="description">Description</label>
                    <textarea class="form-control" type="text" id="description" name="issue[description]"
                        required><%=issue.description%></textarea>
                    <div class="invalid-feedback">
                        Please provide a valid description.
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label" for="priority">Priority</label>
                    <select class="form-control" id="priority" name="issue[priority]" required>
                      <option value="High" <% if(issue.priority == 'High') {%> selected <% } %> >High</option>
                      <option value="Medium" <% if(issue.priority == 'Medium') {%> selected <% } %> >Medium</option>
                      <option value="Low" <% if(issue.priority == 'Low') {%> selected <% } %> >Low</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label" for="status">Status</label>
                    <select class="form-control" id="status" name="issue[status]" required>
                      <option value="Unassigned" <% if(issue.status == 'Unassigned') {%> selected <% } %> >Unassigned</option>
                      <option value="Assigned" <% if(issue.status == 'Assigned') {%> selected <% } %> >Assigned</option>
                      <option value="Resolved" <% if(issue.status == 'Resolved') {%> selected <% } %> >Resolved</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label" for="image">Image Url</label>
                    <input class="form-control" type="text" id="image" name="issue[images]"
                        value="<%= issue.images[0]%>">
                </div>
                <div class=" mb-3">
                    <label class="form-label" for="assigned_to">Assigned To</label>
                    <% if(issue.assigned_to && issue.assigned_to.username.length) { %>
                    <input class="form-control" type="text" id="assigned_to" name="tempUsername"
                        value="<%=issue.assigned_to.username%>">
                    <% } else { %> 
                    <input class="form-control" type="text" id="assigned_to" name="tempUsername">
                    <% } %> 
                </div>
                <!-- if status is assigned then fill this column -->
                <!-- not asked during input, job of admin to assign these values -->
                <!-- inclue modified date and modified by here -->

                <button class="btn btn-sm btn-addIssue">Update Issue</button>
            </form>
        </div>
    </div>
    <a href="/issues/<%=issue._id%>">Back To Issue</a>